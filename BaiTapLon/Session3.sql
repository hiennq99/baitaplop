USE master
GO
DROP DATABASE MODULE3
GO
CREATE DATABASE MODULE3
GO
USE MODULE3
GO

CREATE TABLE AIRCRAFTS
(
	ID_AIR VARCHAR(10) PRIMARY KEY,
	NAME_AIR NVARCHAR(30),
	MAKEMODEL VARCHAR(30),
	TOTALSEATS INT,
	ECONOMYSEATS INT,
	BUSHMESSSEATS INT
)
GO
 CREATE TABLE COUNTRIES
 (
	ID_COUNTRY VARCHAR(10) PRIMARY KEY,
	NAME_COUNTRY NVARCHAR(30)
 )
 GO
 CREATE TABLE ROLES 
 (
	ID_ROLE VARCHAR(10) PRIMARY KEY,
	NAME_ROLE NVARCHAR(30)
 )
 GO
 CREATE TABLE CABINTYPES
 (
	ID_CABIN VARCHAR(10) PRIMARY KEY,
	NAME_CABIN NVARCHAR(30)
 )
 GO
 CREATE TABLE OFFICES
 (
	ID_OFFICES VARCHAR(10) PRIMARY KEY,
	ID_COUNTRY VARCHAR(10),
	TITTLE NVARCHAR(30),
	PHONE NUMERIC,
	CONTACT NVARCHAR(30),
	
	CONSTRAINT OFFICES_FK FOREIGN KEY(ID_COUNTRY) REFERENCES COUNTRIES(ID_COUNTRY) ON UPDATE CASCADE ON DELETE CASCADE
 )
 GO
 CREATE TABLE USERS
 (
	ID_USER VARCHAR(10) PRIMARY KEY,
	ID_ROLE VARCHAR(10),
	ID_OFFICES VARCHAR(10),
	EMAIL VARCHAR(30),
	PASSWORD_USER VARCHAR(30),
	F_NAME NVARCHAR(30),
	L_NAME NVARCHAR(30),
	BIRTHDAY DATETIME,
	CONSTRAINT USERS1 FOREIGN KEY(ID_ROLE) REFERENCES ROLES(ID_ROLE) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT USERS2 FOREIGN KEY(ID_OFFICES) REFERENCES OFFICES(ID_OFFICES) ON UPDATE CASCADE ON DELETE CASCADE
 )
 GO
 CREATE TABLE AIRPORT
 (
	ID_AIRPORT VARCHAR(10) PRIMARY KEY,
	ID_COUNTRY VARCHAR(10),
	IATA_CODE VARCHAR(30),
	NAME_AIRPORT NVARCHAR(30),
	CONSTRAINT AIRPORT_FK FOREIGN KEY(ID_COUNTRY) REFERENCES COUNTRIES(ID_COUNTRY) ON UPDATE CASCADE ON DELETE CASCADE
 )
 GO
 CREATE TABLE ROUTESS
 (
	ID_ROUTE VARCHAR(10) PRIMARY KEY,
	ID_DEPARTURE VARCHAR(10),
	ID_ARRIVAL VARCHAR(10),
	DISTANCE INT,
	FIGH_TIME INT,
	CONSTRAINT ROUTESS1 FOREIGN KEY(ID_DEPARTURE) REFERENCES AIRPORT(ID_AIRPORT) ,
	CONSTRAINT ROUTESS2 FOREIGN KEY(ID_ARRIVAL) REFERENCES AIRPORT(ID_AIRPORT) 
 )
 GO
 CREATE TABLE SCHEDULES 
 (
	ID_SCHEDULE VARCHAR(10) PRIMARY KEY,
	DATE_SCHEDULE DATETIME,
	TIME_SCHEDULE VARCHAR(10),
	ID_AIR VARCHAR(10),
	ID_ROUTE VARCHAR(10),
	FLIGHT_NUMBER INT,
	ECONOMY_PRICE NUMERIC,
	CONFIRMED CHAR(10),
	CONSTRAINT SCHEDULES1 FOREIGN KEY(ID_AIR) REFERENCES AIRCRAFTS(ID_AIR) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT SCHEDULES2 FOREIGN KEY(ID_ROUTE) REFERENCES ROUTESS(ID_ROUTE) ON UPDATE CASCADE ON DELETE CASCADE,
 )
 GO
 CREATE TABLE TICKETS
 (
	ID_TICKET VARCHAR(10) PRIMARY KEY,
	ID_USER VARCHAR(10),
	ID_SCHEDULE VARCHAR(10),
	ID_CABIN VARCHAR(10),
	F_NAME NVARCHAR(30),
	L_NAME NVARCHAR(30),
	EMAIL VARCHAR(30),
	PHONE NUMERIC,
	PASSPORT_NUMBER NUMERIC,
	PASSPORT_COUNTRY VARCHAR(10),
	BOOKING_REFERENCES NVARCHAR(30),
	CONFIRMED CHAR(10),
	CONSTRAINT TICKETS1 FOREIGN KEY(ID_USER) REFERENCES USERS(ID_USER) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT TICKETS2 FOREIGN KEY(ID_SCHEDULE) REFERENCES SCHEDULES(ID_SCHEDULE) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT TICKETS3 FOREIGN KEY(ID_CABIN) REFERENCES CABINTYPES(ID_CABIN) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT TICKETS4 FOREIGN KEY(PASSPORT_COUNTRY) REFERENCES COUNTRIES(ID_COUNTRY),
 )

GO
 INSERT INTO AIRCRAFTS VALUES ('AIR01','Boeing','B001',250,100,150)
 INSERT INTO AIRCRAFTS VALUES ('AIR02','Boeing','B001',250,100,150)
 INSERT INTO AIRCRAFTS VALUES ('AIR03','Foker','B001',300,100,200)
 INSERT INTO AIRCRAFTS VALUES ('AIR04','Kawashaki','B001',300,100,200)
 INSERT INTO AIRCRAFTS VALUES ('AIR05','Boeing','B001',250,100,150)
 go

 INSERT INTO COUNTRIES VALUES('CT01','VIET NAM')
 INSERT INTO COUNTRIES VALUES('CT02','MY')
 INSERT INTO COUNTRIES VALUES('CT03','THAI LAN')
 INSERT INTO COUNTRIES VALUES('CT04','NGA')
 INSERT INTO COUNTRIES VALUES('CT05','NHAT BAN')

 GO

 INSERT INTO ROLES VALUES ('ROLE01','HANH KHACH')
 INSERT INTO ROLES VALUES ('ROLE02','NHAN VIEN')
 GO
 INSERT INTO CABINTYPES VALUES ('CABIN01','CA BIN ')
 INSERT INTO CABINTYPES VALUES ('CABIN02','CA BIN 1 ')
 GO
 INSERT INTO OFFICES VALUES ('OFFICES01','CT01','TIEP TAN', 0123456789,'HELP@GMAIL.COM')
 INSERT INTO OFFICES VALUES ('OFFICES02','CT01','BAN VE', 0123456999,'HELP@GMAIL.COM')
 INSERT INTO OFFICES VALUES ('OFFICES03','CT01','CSKH', 0123456888,'HELP@GMAIL.COM')
 GO
 INSERT INTO AIRPORT VALUES ('APORT01','CT01','100000','NOI BAI')
 INSERT INTO AIRPORT VALUES ('APORT02','CT02','100001','NEW YORK')
 INSERT INTO AIRPORT VALUES ('APORT03','CT03','100002','JAKATA')
 INSERT INTO AIRPORT VALUES ('APORT04','CT05','100004','TOKYO')
 GO
 INSERT INTO ROUTESS VALUES('RT01','CT01','CT01',900,3)
 INSERT INTO ROUTESS VALUES('RT02','CT01','CT01',1900,8)
 INSERT INTO ROUTESS VALUES('RT03','CT01','CT01',2500,9)
 GO
 INSERT INTO SCHEDULES VALUES ('SCH01','11/11/2019','3','AIR01','RT01',1123,'1200','YES')
 INSERT INTO SCHEDULES VALUES ('SCH02','12/11/2019','8','AIR02','RT02',1124,'1500','YES')
 INSERT INTO SCHEDULES VALUES ('SCH03','12/11/2019','9','AIR03','RT03',1125,'1600','YES')

